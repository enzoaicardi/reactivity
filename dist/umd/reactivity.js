!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((t="undefined"!=typeof globalThis?globalThis:t||self).t={})}(this,(function(t){"use strict";class s{static i=Symbol();static h=Symbol();static o=Symbol();static l=Symbol();static u=Symbol();static p=Symbol()}class i{value;[s.i];[s.h];static[s.o]=null;static[s.l]=null;static use=(t,...s)=>new i(t).use(...s);constructor(t){this.value=t,this[s.i]=new Set,this[s.h]=!1}add(t){this[s.i].add(t),t[s.i].add(this)}use(...t){i[s.l]=i[s.o],i[s.o]=this[s.h]?null:this,this[s.h]||(this[s.h]=!0);const e=this.value(...t);return i[s.o]=i[s.l],e}delete(t){this[s.i].delete(t),t[s.i].delete(this)}clear(){for(const t of this[s.i])t[s.i].delete(this);this[s.i].clear()}}class e{value;[s.i];constructor(t){void 0!==t&&(this.value=t),this[s.i]=new Set}get(){const t=i[s.o];return t&&(this[s.i].add(t),t[s.i].add(this)),this.value}set(t){if(this.value!==t){this.value=t;for(const t of this[s.i])t.use()}return this.value}delete(t){this[s.i].delete(t),t[s.i].delete(this)}clear(){for(const t of this[s.i])t[s.i].delete(this);this[s.i].clear()}}t.S=class extends e{[s.u];[s.p];entry;constructor(t){super(),this[s.u]=t,this[s.p]=new i((()=>this.set(this.entry))),this[s.p].use()}set(t){return this.entry=t,t=this[s.u](t),super.set(t)}clear(){delete this.entry,this[s.p]&&this[s.p].clear(),super.clear()}},t.v=i,t.T=e}));
